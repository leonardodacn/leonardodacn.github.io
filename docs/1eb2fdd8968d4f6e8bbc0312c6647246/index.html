<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>DataX OracleWriter | haokiu</title>
<meta name="keywords" content="datax">
<meta name="description" content="DataX OracleWriter 1 快速介绍 OracleWriter 插件实现了写入数据到 Oracle 主库的目的表的功能。在底层实现上， OracleWriter 通过 JDBC 连接远程 Oracle 数据库，并执行相应的 insert into &hellip; sql 语句将数据写入 Oracle，内部会分批次提交入库。
OracleWriter 面向ETL开发工程师，他们使用 OracleWriter 从数仓导入数据到 Oracle。同时 OracleWriter 亦可以作为数据迁移工具为DBA等用户提供服务。
2 实现原理 OracleWriter 通过 DataX 框架获取 Reader 生成的协议数据，根据你配置生成相应的SQL语句
insert into...(当主键/唯一性索引冲突时会写不进去冲突的行) 注意： 1. 目的表所在数据库必须是主库才能写入数据；整个任务至少需具备 insert into...的权限，是否需要其他权限，取决于你任务配置中在 preSql 和 postSql 中指定的语句。 2.OracleWriter和MysqlWriter不同，不支持配置writeMode参数。 3 功能说明 3.1 配置样例 这里使用一份从内存产生到 Oracle 导入的数据。 { &#34;job&#34;: { &#34;setting&#34;: { &#34;speed&#34;: { &#34;channel&#34;: 1 } }, &#34;content&#34;: [ { &#34;reader&#34;: { &#34;name&#34;: &#34;streamreader&#34;, &#34;parameter&#34;: { &#34;column&#34; : [ { &#34;value&#34;: &#34;DataX&#34;, &#34;type&#34;: &#34;string&#34; }, { &#34;value&#34;: 19880808, &#34;type&#34;: &#34;long&#34; }, { &#34;value&#34;: &#34;1988-08-08 08:08:08&#34;, &#34;type&#34;: &#34;date&#34; }, { &#34;value&#34;: true, &#34;type&#34;: &#34;bool&#34; }, { &#34;value&#34;: &#34;test&#34;, &#34;type&#34;: &#34;bytes&#34; } ], &#34;sliceRecordCount&#34;: 1000 } }, &#34;writer&#34;: { &#34;name&#34;: &#34;oraclewriter&#34;, &#34;parameter&#34;: { &#34;username&#34;: &#34;root&#34;, &#34;password&#34;: &#34;root&#34;, &#34;column&#34;: [ &#34;id&#34;, &#34;name&#34; ], &#34;preSql&#34;: [ &#34;delete from test&#34; ], &#34;connection&#34;: [ { &#34;jdbcUrl&#34;: &#34;jdbc:oracle:thin:@[HOST_NAME]:PORT:[DATABASE_NAME]&#34;, &#34;table&#34;: [ &#34;test&#34; ] } ] } } } ] } } 3.">
<meta name="author" content="">
<link rel="canonical" href="https://haokiu.com/1eb2fdd8968d4f6e8bbc0312c6647246/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://haokiu.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://haokiu.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://haokiu.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://haokiu.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://haokiu.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="DataX OracleWriter" />
<meta property="og:description" content="DataX OracleWriter 1 快速介绍 OracleWriter 插件实现了写入数据到 Oracle 主库的目的表的功能。在底层实现上， OracleWriter 通过 JDBC 连接远程 Oracle 数据库，并执行相应的 insert into &hellip; sql 语句将数据写入 Oracle，内部会分批次提交入库。
OracleWriter 面向ETL开发工程师，他们使用 OracleWriter 从数仓导入数据到 Oracle。同时 OracleWriter 亦可以作为数据迁移工具为DBA等用户提供服务。
2 实现原理 OracleWriter 通过 DataX 框架获取 Reader 生成的协议数据，根据你配置生成相应的SQL语句
insert into...(当主键/唯一性索引冲突时会写不进去冲突的行) 注意： 1. 目的表所在数据库必须是主库才能写入数据；整个任务至少需具备 insert into...的权限，是否需要其他权限，取决于你任务配置中在 preSql 和 postSql 中指定的语句。 2.OracleWriter和MysqlWriter不同，不支持配置writeMode参数。 3 功能说明 3.1 配置样例 这里使用一份从内存产生到 Oracle 导入的数据。 { &#34;job&#34;: { &#34;setting&#34;: { &#34;speed&#34;: { &#34;channel&#34;: 1 } }, &#34;content&#34;: [ { &#34;reader&#34;: { &#34;name&#34;: &#34;streamreader&#34;, &#34;parameter&#34;: { &#34;column&#34; : [ { &#34;value&#34;: &#34;DataX&#34;, &#34;type&#34;: &#34;string&#34; }, { &#34;value&#34;: 19880808, &#34;type&#34;: &#34;long&#34; }, { &#34;value&#34;: &#34;1988-08-08 08:08:08&#34;, &#34;type&#34;: &#34;date&#34; }, { &#34;value&#34;: true, &#34;type&#34;: &#34;bool&#34; }, { &#34;value&#34;: &#34;test&#34;, &#34;type&#34;: &#34;bytes&#34; } ], &#34;sliceRecordCount&#34;: 1000 } }, &#34;writer&#34;: { &#34;name&#34;: &#34;oraclewriter&#34;, &#34;parameter&#34;: { &#34;username&#34;: &#34;root&#34;, &#34;password&#34;: &#34;root&#34;, &#34;column&#34;: [ &#34;id&#34;, &#34;name&#34; ], &#34;preSql&#34;: [ &#34;delete from test&#34; ], &#34;connection&#34;: [ { &#34;jdbcUrl&#34;: &#34;jdbc:oracle:thin:@[HOST_NAME]:PORT:[DATABASE_NAME]&#34;, &#34;table&#34;: [ &#34;test&#34; ] } ] } } } ] } } 3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://haokiu.com/1eb2fdd8968d4f6e8bbc0312c6647246/" /><meta property="article:section" content="4" />
<meta property="article:published_time" content="2021-02-02T17:45:01+00:00" />
<meta property="article:modified_time" content="2021-02-02T17:45:01+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="DataX OracleWriter"/>
<meta name="twitter:description" content="DataX OracleWriter 1 快速介绍 OracleWriter 插件实现了写入数据到 Oracle 主库的目的表的功能。在底层实现上， OracleWriter 通过 JDBC 连接远程 Oracle 数据库，并执行相应的 insert into &hellip; sql 语句将数据写入 Oracle，内部会分批次提交入库。
OracleWriter 面向ETL开发工程师，他们使用 OracleWriter 从数仓导入数据到 Oracle。同时 OracleWriter 亦可以作为数据迁移工具为DBA等用户提供服务。
2 实现原理 OracleWriter 通过 DataX 框架获取 Reader 生成的协议数据，根据你配置生成相应的SQL语句
insert into...(当主键/唯一性索引冲突时会写不进去冲突的行) 注意： 1. 目的表所在数据库必须是主库才能写入数据；整个任务至少需具备 insert into...的权限，是否需要其他权限，取决于你任务配置中在 preSql 和 postSql 中指定的语句。 2.OracleWriter和MysqlWriter不同，不支持配置writeMode参数。 3 功能说明 3.1 配置样例 这里使用一份从内存产生到 Oracle 导入的数据。 { &#34;job&#34;: { &#34;setting&#34;: { &#34;speed&#34;: { &#34;channel&#34;: 1 } }, &#34;content&#34;: [ { &#34;reader&#34;: { &#34;name&#34;: &#34;streamreader&#34;, &#34;parameter&#34;: { &#34;column&#34; : [ { &#34;value&#34;: &#34;DataX&#34;, &#34;type&#34;: &#34;string&#34; }, { &#34;value&#34;: 19880808, &#34;type&#34;: &#34;long&#34; }, { &#34;value&#34;: &#34;1988-08-08 08:08:08&#34;, &#34;type&#34;: &#34;date&#34; }, { &#34;value&#34;: true, &#34;type&#34;: &#34;bool&#34; }, { &#34;value&#34;: &#34;test&#34;, &#34;type&#34;: &#34;bytes&#34; } ], &#34;sliceRecordCount&#34;: 1000 } }, &#34;writer&#34;: { &#34;name&#34;: &#34;oraclewriter&#34;, &#34;parameter&#34;: { &#34;username&#34;: &#34;root&#34;, &#34;password&#34;: &#34;root&#34;, &#34;column&#34;: [ &#34;id&#34;, &#34;name&#34; ], &#34;preSql&#34;: [ &#34;delete from test&#34; ], &#34;connection&#34;: [ { &#34;jdbcUrl&#34;: &#34;jdbc:oracle:thin:@[HOST_NAME]:PORT:[DATABASE_NAME]&#34;, &#34;table&#34;: [ &#34;test&#34; ] } ] } } } ] } } 3."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "4s",
      "item": "https://haokiu.com/4/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "DataX OracleWriter",
      "item": "https://haokiu.com/1eb2fdd8968d4f6e8bbc0312c6647246/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "DataX OracleWriter",
  "name": "DataX OracleWriter",
  "description": "DataX OracleWriter 1 快速介绍 OracleWriter 插件实现了写入数据到 Oracle 主库的目的表的功能。在底层实现上， OracleWriter 通过 JDBC 连接远程 Oracle 数据库，并执行相应的 insert into \u0026hellip; sql 语句将数据写入 Oracle，内部会分批次提交入库。\nOracleWriter 面向ETL开发工程师，他们使用 OracleWriter 从数仓导入数据到 Oracle。同时 OracleWriter 亦可以作为数据迁移工具为DBA等用户提供服务。\n2 实现原理 OracleWriter 通过 DataX 框架获取 Reader 生成的协议数据，根据你配置生成相应的SQL语句\ninsert into...(当主键/唯一性索引冲突时会写不进去冲突的行) 注意： 1. 目的表所在数据库必须是主库才能写入数据；整个任务至少需具备 insert into...的权限，是否需要其他权限，取决于你任务配置中在 preSql 和 postSql 中指定的语句。 2.OracleWriter和MysqlWriter不同，不支持配置writeMode参数。 3 功能说明 3.1 配置样例 这里使用一份从内存产生到 Oracle 导入的数据。 { \u0026#34;job\u0026#34;: { \u0026#34;setting\u0026#34;: { \u0026#34;speed\u0026#34;: { \u0026#34;channel\u0026#34;: 1 } }, \u0026#34;content\u0026#34;: [ { \u0026#34;reader\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;streamreader\u0026#34;, \u0026#34;parameter\u0026#34;: { \u0026#34;column\u0026#34; : [ { \u0026#34;value\u0026#34;: \u0026#34;DataX\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;string\u0026#34; }, { \u0026#34;value\u0026#34;: 19880808, \u0026#34;type\u0026#34;: \u0026#34;long\u0026#34; }, { \u0026#34;value\u0026#34;: \u0026#34;1988-08-08 08:08:08\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;date\u0026#34; }, { \u0026#34;value\u0026#34;: true, \u0026#34;type\u0026#34;: \u0026#34;bool\u0026#34; }, { \u0026#34;value\u0026#34;: \u0026#34;test\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;bytes\u0026#34; } ], \u0026#34;sliceRecordCount\u0026#34;: 1000 } }, \u0026#34;writer\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;oraclewriter\u0026#34;, \u0026#34;parameter\u0026#34;: { \u0026#34;username\u0026#34;: \u0026#34;root\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;root\u0026#34;, \u0026#34;column\u0026#34;: [ \u0026#34;id\u0026#34;, \u0026#34;name\u0026#34; ], \u0026#34;preSql\u0026#34;: [ \u0026#34;delete from test\u0026#34; ], \u0026#34;connection\u0026#34;: [ { \u0026#34;jdbcUrl\u0026#34;: \u0026#34;jdbc:oracle:thin:@[HOST_NAME]:PORT:[DATABASE_NAME]\u0026#34;, \u0026#34;table\u0026#34;: [ \u0026#34;test\u0026#34; ] } ] } } } ] } } 3.",
  "keywords": [
    "datax"
  ],
  "articleBody": "DataX OracleWriter 1 快速介绍 OracleWriter 插件实现了写入数据到 Oracle 主库的目的表的功能。在底层实现上， OracleWriter 通过 JDBC 连接远程 Oracle 数据库，并执行相应的 insert into … sql 语句将数据写入 Oracle，内部会分批次提交入库。\nOracleWriter 面向ETL开发工程师，他们使用 OracleWriter 从数仓导入数据到 Oracle。同时 OracleWriter 亦可以作为数据迁移工具为DBA等用户提供服务。\n2 实现原理 OracleWriter 通过 DataX 框架获取 Reader 生成的协议数据，根据你配置生成相应的SQL语句\ninsert into...(当主键/唯一性索引冲突时会写不进去冲突的行) 注意： 1. 目的表所在数据库必须是主库才能写入数据；整个任务至少需具备 insert into...的权限，是否需要其他权限，取决于你任务配置中在 preSql 和 postSql 中指定的语句。 2.OracleWriter和MysqlWriter不同，不支持配置writeMode参数。 3 功能说明 3.1 配置样例 这里使用一份从内存产生到 Oracle 导入的数据。 { \"job\": { \"setting\": { \"speed\": { \"channel\": 1 } }, \"content\": [ { \"reader\": { \"name\": \"streamreader\", \"parameter\": { \"column\" : [ { \"value\": \"DataX\", \"type\": \"string\" }, { \"value\": 19880808, \"type\": \"long\" }, { \"value\": \"1988-08-08 08:08:08\", \"type\": \"date\" }, { \"value\": true, \"type\": \"bool\" }, { \"value\": \"test\", \"type\": \"bytes\" } ], \"sliceRecordCount\": 1000 } }, \"writer\": { \"name\": \"oraclewriter\", \"parameter\": { \"username\": \"root\", \"password\": \"root\", \"column\": [ \"id\", \"name\" ], \"preSql\": [ \"delete from test\" ], \"connection\": [ { \"jdbcUrl\": \"jdbc:oracle:thin:@[HOST_NAME]:PORT:[DATABASE_NAME]\", \"table\": [ \"test\" ] } ] } } } ] } } 3.2 参数说明 jdbcUrl\n描述：目的数据库的 JDBC 连接信息 ,jdbcUrl必须包含在connection配置单元中。\n注意：1、在一个数据库上只能配置一个值。这与 OracleReader 支持多个备库探测不同，因为此处不支持同一个数据库存在多个主库的情况(双主导入数据情况) 2、jdbcUrl按照Oracle官方规范，并可以填写连接附加参数信息。具体请参看 Oracle官方文档或者咨询对应 DBA。 必选：是 默认值：无 username\n描述：目的数据库的用户名 必选：是 默认值：无 password\n描述：目的数据库的密码 必选：是 默认值：无 table\n描述：目的表的表名称。支持写入一个或者多个表。当配置为多张表时，必须确保所有表结构保持一致。\n注意：table 和 jdbcUrl 必须包含在 connection 配置单元中 必选：是 默认值：无 column\n描述：目的表需要写入数据的字段,字段之间用英文逗号分隔。例如: “column”: [“id”,“name”,“age”]。如果要依次写入全部列，使用表示, 例如: “column”: [\"\"]\n**column配置项必须指定，不能留空！** 注意：1、我们强烈不推荐你这样配置，因为当你目的表字段个数、类型等有改动时，你的任务可能运行不正确或者失败 2、此处 column 不能配置任何常量值 必选：是 默认值：否 preSql\n描述：写入数据到目的表前，会先执行这里的标准语句。如果 Sql 中有你需要操作到的表名称，请使用 @table 表示，这样在实际执行 Sql 语句时，会对变量按照实际表名称进行替换。比如你的任务是要写入到目的端的100个同构分表(表名称为:datax_00,datax01, … datax_98,datax_99)，并且你希望导入数据前，先对表中数据进行删除操作，那么你可以这样配置：\"preSql\":[\"delete from @table\"]，效果是：在执行到每个表写入数据前，会先执行对应的 delete from 对应表名称 必选：否 默认值：无 postSql\n描述：写入数据到目的表后，会执行这里的标准语句。（原理同 preSql ） 必选：否 默认值：无 batchSize\n描述：一次性批量提交的记录数大小，该值可以极大减少DataX与Oracle的网络交互次数，并提升整体吞吐量。但是该值设置过大可能会造成DataX运行进程OOM情况。\n必选：否 默认值：1024 session\n描述：设置oracle连接时的session信息，格式示例如下： \"session\":[ \"alter session set nls_date_format = 'dd.mm.yyyy hh24:mi:ss';\" \"alter session set NLS_LANG = 'AMERICAN';\" ] 必选：否 默认值：无 3.3 类型转换 类似 OracleReader ，目前 OracleWriter 支持大部分 Oracle 类型，但也存在部分个别类型没有支持的情况，请注意检查你的类型。\n下面列出 OracleWriter 针对 Oracle 类型转换列表:\nDataX 内部类型 Oracle 数据类型 Long NUMBER,INTEGER,INT,SMALLINT Double NUMERIC,DECIMAL,FLOAT,DOUBLE PRECISION,REAL String LONG,CHAR,NCHAR,VARCHAR,VARCHAR2,NVARCHAR2,CLOB,NCLOB,CHARACTER,CHARACTER VARYING,CHAR VARYING,NATIONAL CHARACTER,NATIONAL CHAR,NATIONAL CHARACTER VARYING,NATIONAL CHAR VARYING,NCHAR VARYING Date TIMESTAMP,DATE Boolean bit, bool Bytes BLOB,BFILE,RAW,LONG RAW 4 性能报告 4.1 环境准备 4.1.1 数据特征 建表语句：\n--DROP TABLE PERF_ORACLE_WRITER; CREATE TABLE PERF_ORACLE_WRITER ( COL1 VARCHAR2(255 BYTE) NULL , COL2 NUMBER(32) NULL , COL3 NUMBER(32) NULL , COL4 DATE NULL , COL5 FLOAT NULL , COL6 VARCHAR2(255 BYTE) NULL , COL7 VARCHAR2(255 BYTE) NULL , COL8 VARCHAR2(255 BYTE) NULL , COL9 VARCHAR2(255 BYTE) NULL , COL10 VARCHAR2(255 BYTE) NULL ) LOGGING NOCOMPRESS NOCACHE; 单行记录类似于：\ncol1:485924f6ab7f272af361cd3f7f2d23e0d764942351#$%^\u0026fdafdasfdas%%^(*\u0026^^\u0026* co12:1 co13:1696248667889 co14:2013-01-06 00:00:00 co15:3.141592653578 co16:100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11209 co17:100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11fdsafdsfdsa209 co18:100DAFDSAFDSAHOFJDPSAWIFDISHAF;dsadsafdsahfdsajf;dsfdsa;FJDSAL;11209 co19:100dafdsafdsahofjdpsawifdishaf;DSADSAFDSAHFDSAJF;dsfdsa;fjdsal;11209 co110:12~!2345100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11209 4.1.2 机器参数 执行 DataX 的机器参数为:\ncpu: 24 Core Intel(R) Xeon(R) CPU E5-2430 0 @ 2.20GHz mem: 94GB net: 千兆双网卡 disc: DataX 数据不落磁盘，不统计此项 Oracle 数据库机器参数为:\ncpu: 4 Core Intel(R) Xeon(R) CPU E5420 @ 2.50GHz mem: 7GB 4.1.3 DataX jvm 参数 -Xms1024m -Xmx1024m -XX:+HeapDumpOnOutOfMemoryError 4.1.4 性能测试作业配置 { \"job\": { \"setting\": { \"speed\": { \"channel\": 4 } }, \"content\": [ { \"reader\": { \"name\": \"streamreader\", \"parameter\": { \"sliceRecordCount\": 1000000000, \"column\": [ { \"value\": \"485924f6ab7f272af361cd3f7f2d23e0d764942351#$%^\u0026fdafdasfdas%%^(*\u0026^^\u0026*\" }, { \"value\": 1, \"type\": \"long\" }, { \"value\": \"1696248667889\", \"type\": \"long\" }, { \"type\": \"date\", \"value\": \"2013-07-06 00:00:00\", \"dateFormat\": \"yyyy-mm-dd hh:mm:ss\" }, { \"value\": \"3.141592653578\", \"type\": \"double\" }, { \"value\": \"100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11209\" }, { \"value\": \"100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11fdsafdsfdsa209\" }, { \"value\": \"100DAFDSAFDSAHOFJDPSAWIFDISHAF;dsadsafdsahfdsajf;dsfdsa;FJDSAL;11209\" }, { \"value\": \"100dafdsafdsahofjdpsawifdishaf;DSADSAFDSAHFDSAJF;dsfdsa;fjdsal;11209\" }, { \"value\": \"12~!2345100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11209\" } ] } }, \"writer\": { \"name\": \"oraclewriter\", \"parameter\": { \"username\": \"username\", \"password\": \"password\", \"truncate\": \"true\", \"batchSize\": \"512\", \"column\": [ \"col1\", \"col2\", \"col3\", \"col4\", \"col5\", \"col6\", \"col7\", \"col8\", \"col9\", \"col10\" ], \"connection\": [ { \"table\": [ \"PERF_ORACLE_WRITER\" ], \"jdbcUrl\": \"jdbc:oracle:thin:@ip:port:dataplat\" } ] } } } ] } } 4.2 测试报告 4.2.1 测试报告 通道数 批量提交行数 DataX速度(Rec/s) DataX流量(MB/s) DataX机器网卡流出流量(MB/s) DataX机器运行负载 DB网卡进入流量(MB/s) DB运行负载 1 128 15564 6.51 7.5 0.02 7.4 1.08 1 512 29491 10.90 12.6 0.05 12.4 1.55 1 1024 31529 11.87 13.5 0.22 13.3 1.58 1 2048 33469 12.57 14.3 0.17 14.3 1.53 1 4096 31363 12.48 13.4 0.10 10.0 1.72 4 10 9440 4.05 5.6 0.01 5.0 3.75 4 128 42832 16.48 18.3 0.07 18.5 2.89 4 512 46643 20.02 22.7 0.35 21.1 3.31 4 1024 39116 16.79 18.7 0.10 18.1 3.05 4 2048 39526 16.96 18.5 0.32 17.1 2.86 4 4096 37683 16.17 17.2 0.23 15.5 2.26 8 128 38336 16.45 17.5 0.13 16.2 3.87 8 512 31078 13.34 14.9 0.11 13.4 2.09 8 1024 37888 16.26 18.5 0.20 18.5 3.14 8 2048 38502 16.52 18.5 0.18 18.5 2.96 8 4096 38092 16.35 18.3 0.10 17.8 3.19 16 128 35366 15.18 16.9 0.13 15.6 3.49 16 512 35584 15.27 16.8 0.23 17.4 3.05 16 1024 38297 16.44 17.5 0.20 17.0 3.42 16 2048 28467 12.22 13.8 0.10 12.4 3.38 16 4096 27852 11.95 12.3 0.11 12.3 3.86 32 1024 34406 14.77 15.4 0.09 15.4 3.55 batchSize 和 通道个数，对性能影响较大 通常不建议写入数据库时，通道个数 \u003e32 5 约束限制 FAQ Q: OracleWriter 执行 postSql 语句报错，那么数据导入到目标数据库了吗?\nA: DataX 导入过程存在三块逻辑，pre 操作、导入操作、post 操作，其中任意一环报错，DataX 作业报错。由于 DataX 不能保证在同一个事务完成上述几个操作，因此有可能数据已经落入到目标端。\nQ: 按照上述说法，那么有部分脏数据导入数据库，如果影响到线上数据库怎么办?\nA: 目前有两种解法，第一种配置 pre 语句，该 sql 可以清理当天导入数据， DataX 每次导入时候可以把上次清理干净并导入完整数据。第二种，向临时表导入数据，完成后再 rename 到线上表。\nQ: 上面第二种方法可以避免对线上数据造成影响，那我具体怎样操作?\nA: 可以配置临时表导入\n",
  "wordCount" : "753",
  "inLanguage": "en",
  "datePublished": "2021-02-02T17:45:01Z",
  "dateModified": "2021-02-02T17:45:01Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://haokiu.com/1eb2fdd8968d4f6e8bbc0312c6647246/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "haokiu",
    "logo": {
      "@type": "ImageObject",
      "url": "https://haokiu.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://haokiu.com/" accesskey="h" title="haokiu (Alt + H)">haokiu</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://haokiu.com/" title="haokiu">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://haokiu.com/1/" title="1s">
                    <span>后端</span>
                </a>
            </li>
            <li>
                <a href="https://haokiu.com/2/" title="2s">
                    <span>前端</span>
                </a>
            </li>
            <li>
                <a href="https://haokiu.com/3/" title="3s">
                    <span>区块链</span>
                </a>
            </li>
            <li>
                <a href="https://haokiu.com/4/" title="4s">
                    <span>大数据</span>
                </a>
            </li>
            <li>
                <a href="https://haokiu.com/5/" title="5s">
                    <span>linux</span>
                </a>
            </li>
            <li>
                <a href="https://haokiu.com/6/" title="6s">
                    <span>其他</span>
                </a>
            </li>
            <li>
                <a href="https://haokiu.com/tags/" title="Tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://haokiu.com/categories/" title="Categories">
                    <span>categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://haokiu.com/">Home</a>&nbsp;»&nbsp;<a href="https://haokiu.com/4/">4s</a></div>
    <h1 class="post-title">
      DataX OracleWriter
    </h1>
    <div class="post-meta"><span title='2021-02-02 17:45:01 +0000 UTC'>February 2, 2021</span>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#datax-oraclewriter" aria-label="DataX OracleWriter">DataX OracleWriter</a><ul>
                        
                <li>
                    <a href="#1-%e5%bf%ab%e9%80%9f%e4%bb%8b%e7%bb%8d" aria-label="1 快速介绍">1 快速介绍</a></li>
                <li>
                    <a href="#2-%e5%ae%9e%e7%8e%b0%e5%8e%9f%e7%90%86" aria-label="2 实现原理">2 实现原理</a></li>
                <li>
                    <a href="#3-%e5%8a%9f%e8%83%bd%e8%af%b4%e6%98%8e" aria-label="3 功能说明">3 功能说明</a><ul>
                        
                <li>
                    <a href="#31-%e9%85%8d%e7%bd%ae%e6%a0%b7%e4%be%8b" aria-label="3.1 配置样例">3.1 配置样例</a></li>
                <li>
                    <a href="#32-%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e" aria-label="3.2 参数说明">3.2 参数说明</a></li>
                <li>
                    <a href="#33-%e7%b1%bb%e5%9e%8b%e8%bd%ac%e6%8d%a2" aria-label="3.3 类型转换">3.3 类型转换</a></li></ul>
                </li>
                <li>
                    <a href="#4-%e6%80%a7%e8%83%bd%e6%8a%a5%e5%91%8a" aria-label="4 性能报告">4 性能报告</a><ul>
                        
                <li>
                    <a href="#41-%e7%8e%af%e5%a2%83%e5%87%86%e5%a4%87" aria-label="4.1 环境准备">4.1 环境准备</a><ul>
                        
                <li>
                    <a href="#411-%e6%95%b0%e6%8d%ae%e7%89%b9%e5%be%81" aria-label="4.1.1 数据特征">4.1.1 数据特征</a></li>
                <li>
                    <a href="#412-%e6%9c%ba%e5%99%a8%e5%8f%82%e6%95%b0" aria-label="4.1.2 机器参数">4.1.2 机器参数</a></li>
                <li>
                    <a href="#413-datax-jvm-%e5%8f%82%e6%95%b0" aria-label="4.1.3 DataX jvm 参数">4.1.3 DataX jvm 参数</a></li>
                <li>
                    <a href="#414-%e6%80%a7%e8%83%bd%e6%b5%8b%e8%af%95%e4%bd%9c%e4%b8%9a%e9%85%8d%e7%bd%ae" aria-label="4.1.4 性能测试作业配置">4.1.4 性能测试作业配置</a></li></ul>
                </li>
                <li>
                    <a href="#42-%e6%b5%8b%e8%af%95%e6%8a%a5%e5%91%8a" aria-label="4.2 测试报告">4.2 测试报告</a><ul>
                        
                <li>
                    <a href="#421-%e6%b5%8b%e8%af%95%e6%8a%a5%e5%91%8a" aria-label="4.2.1 测试报告">4.2.1 测试报告</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#5-%e7%ba%a6%e6%9d%9f%e9%99%90%e5%88%b6" aria-label="5 约束限制">5 约束限制</a></li>
                <li>
                    <a href="#faq" aria-label="FAQ">FAQ</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="datax-oraclewriter">DataX OracleWriter</h1>
<hr>
<h2 id="1-快速介绍">1 快速介绍</h2>
<p>OracleWriter 插件实现了写入数据到 Oracle 主库的目的表的功能。在底层实现上， OracleWriter 通过 JDBC 连接远程 Oracle 数据库，并执行相应的 insert into &hellip;  sql 语句将数据写入 Oracle，内部会分批次提交入库。</p>
<p>OracleWriter 面向ETL开发工程师，他们使用 OracleWriter 从数仓导入数据到 Oracle。同时 OracleWriter 亦可以作为数据迁移工具为DBA等用户提供服务。</p>
<h2 id="2-实现原理">2 实现原理</h2>
<p>OracleWriter 通过 DataX 框架获取 Reader 生成的协议数据，根据你配置生成相应的SQL语句</p>
<ul>
<li><code>insert into...</code>(当主键/唯一性索引冲突时会写不进去冲突的行)</li>
</ul>
<!-- raw HTML omitted -->
<pre><code>注意：
1. 目的表所在数据库必须是主库才能写入数据；整个任务至少需具备 insert into...的权限，是否需要其他权限，取决于你任务配置中在 preSql 和 postSql 中指定的语句。
2.OracleWriter和MysqlWriter不同，不支持配置writeMode参数。
</code></pre>
<h2 id="3-功能说明">3 功能说明</h2>
<h3 id="31-配置样例">3.1 配置样例</h3>
<ul>
<li>这里使用一份从内存产生到 Oracle 导入的数据。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;job&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;setting&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;speed&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;channel&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;content&#34;</span>: [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                 <span style="color:#f92672">&#34;reader&#34;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;streamreader&#34;</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;parameter&#34;</span>: {
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&#34;column&#34;</span> : [
</span></span><span style="display:flex;"><span>                            {
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;DataX&#34;</span>,
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span>
</span></span><span style="display:flex;"><span>                            },
</span></span><span style="display:flex;"><span>                            {
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#ae81ff">19880808</span>,
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;long&#34;</span>
</span></span><span style="display:flex;"><span>                            },
</span></span><span style="display:flex;"><span>                            {
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;1988-08-08 08:08:08&#34;</span>,
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;date&#34;</span>
</span></span><span style="display:flex;"><span>                            },
</span></span><span style="display:flex;"><span>                            {
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;bool&#34;</span>
</span></span><span style="display:flex;"><span>                            },
</span></span><span style="display:flex;"><span>                            {
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;test&#34;</span>,
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;bytes&#34;</span>
</span></span><span style="display:flex;"><span>                            }
</span></span><span style="display:flex;"><span>                        ],
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&#34;sliceRecordCount&#34;</span>: <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                },
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;writer&#34;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;oraclewriter&#34;</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;parameter&#34;</span>: {
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&#34;username&#34;</span>: <span style="color:#e6db74">&#34;root&#34;</span>,
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&#34;password&#34;</span>: <span style="color:#e6db74">&#34;root&#34;</span>,
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&#34;column&#34;</span>: [
</span></span><span style="display:flex;"><span>                            <span style="color:#e6db74">&#34;id&#34;</span>,
</span></span><span style="display:flex;"><span>                            <span style="color:#e6db74">&#34;name&#34;</span>
</span></span><span style="display:flex;"><span>                        ],
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&#34;preSql&#34;</span>: [
</span></span><span style="display:flex;"><span>                            <span style="color:#e6db74">&#34;delete from test&#34;</span>
</span></span><span style="display:flex;"><span>                        ],
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&#34;connection&#34;</span>: [
</span></span><span style="display:flex;"><span>                            {
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;jdbcUrl&#34;</span>: <span style="color:#e6db74">&#34;jdbc:oracle:thin:@[HOST_NAME]:PORT:[DATABASE_NAME]&#34;</span>,
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&#34;table&#34;</span>: [
</span></span><span style="display:flex;"><span>                                    <span style="color:#e6db74">&#34;test&#34;</span>
</span></span><span style="display:flex;"><span>                                ]
</span></span><span style="display:flex;"><span>                            }
</span></span><span style="display:flex;"><span>                        ]
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="32-参数说明">3.2 参数说明</h3>
<ul>
<li>
<p><strong>jdbcUrl</strong></p>
<ul>
<li>
<p>描述：目的数据库的 JDBC 连接信息 ,jdbcUrl必须包含在connection配置单元中。</p>
<pre><code>     注意：1、在一个数据库上只能配置一个值。这与 OracleReader 支持多个备库探测不同，因为此处不支持同一个数据库存在多个主库的情况(双主导入数据情况)
          2、jdbcUrl按照Oracle官方规范，并可以填写连接附加参数信息。具体请参看 Oracle官方文档或者咨询对应 DBA。
</code></pre>
</li>
<li>
<p>必选：是 <!-- raw HTML omitted --></p>
</li>
<li>
<p>默认值：无 <!-- raw HTML omitted --></p>
</li>
</ul>
</li>
<li>
<p><strong>username</strong></p>
<ul>
<li>
<p>描述：目的数据库的用户名 <!-- raw HTML omitted --></p>
</li>
<li>
<p>必选：是 <!-- raw HTML omitted --></p>
</li>
<li>
<p>默认值：无 <!-- raw HTML omitted --></p>
</li>
</ul>
</li>
<li>
<p><strong>password</strong></p>
<ul>
<li>
<p>描述：目的数据库的密码 <!-- raw HTML omitted --></p>
</li>
<li>
<p>必选：是 <!-- raw HTML omitted --></p>
</li>
<li>
<p>默认值：无 <!-- raw HTML omitted --></p>
</li>
</ul>
</li>
<li>
<p><strong>table</strong></p>
<ul>
<li>
<p>描述：目的表的表名称。支持写入一个或者多个表。当配置为多张表时，必须确保所有表结构保持一致。</p>
<pre><code>       注意：table 和 jdbcUrl 必须包含在 connection 配置单元中
</code></pre>
</li>
<li>
<p>必选：是 <!-- raw HTML omitted --></p>
</li>
<li>
<p>默认值：无 <!-- raw HTML omitted --></p>
</li>
</ul>
</li>
<li>
<p><strong>column</strong></p>
<ul>
<li>
<p>描述：目的表需要写入数据的字段,字段之间用英文逗号分隔。例如: &ldquo;column&rdquo;: [&ldquo;id&rdquo;,&ldquo;name&rdquo;,&ldquo;age&rdquo;]。如果要依次写入全部列，使用<em>表示, 例如: &ldquo;column&rdquo;: [&quot;</em>&quot;]</p>
<pre><code>	**column配置项必须指定，不能留空！**


       注意：1、我们强烈不推荐你这样配置，因为当你目的表字段个数、类型等有改动时，你的任务可能运行不正确或者失败
            2、此处 column 不能配置任何常量值
</code></pre>
</li>
<li>
<p>必选：是 <!-- raw HTML omitted --></p>
</li>
<li>
<p>默认值：否 <!-- raw HTML omitted --></p>
</li>
</ul>
</li>
<li>
<p><strong>preSql</strong></p>
<ul>
<li>
<p>描述：写入数据到目的表前，会先执行这里的标准语句。如果 Sql 中有你需要操作到的表名称，请使用 <code>@table</code> 表示，这样在实际执行 Sql 语句时，会对变量按照实际表名称进行替换。比如你的任务是要写入到目的端的100个同构分表(表名称为:datax_00,datax01, &hellip; datax_98,datax_99)，并且你希望导入数据前，先对表中数据进行删除操作，那么你可以这样配置：<code>&quot;preSql&quot;:[&quot;delete from @table&quot;]</code>，效果是：在执行到每个表写入数据前，会先执行对应的 delete from 对应表名称 <!-- raw HTML omitted --></p>
</li>
<li>
<p>必选：否 <!-- raw HTML omitted --></p>
</li>
<li>
<p>默认值：无 <!-- raw HTML omitted --></p>
</li>
</ul>
</li>
<li>
<p><strong>postSql</strong></p>
<ul>
<li>
<p>描述：写入数据到目的表后，会执行这里的标准语句。（原理同 preSql ） <!-- raw HTML omitted --></p>
</li>
<li>
<p>必选：否 <!-- raw HTML omitted --></p>
</li>
<li>
<p>默认值：无 <!-- raw HTML omitted --></p>
</li>
</ul>
</li>
<li>
<p><strong>batchSize</strong></p>
<ul>
<li>
<p>描述：一次性批量提交的记录数大小，该值可以极大减少DataX与Oracle的网络交互次数，并提升整体吞吐量。但是该值设置过大可能会造成DataX运行进程OOM情况。<!-- raw HTML omitted --></p>
</li>
<li>
<p>必选：否 <!-- raw HTML omitted --></p>
</li>
<li>
<p>默认值：1024 <!-- raw HTML omitted --></p>
</li>
</ul>
</li>
<li>
<p><strong>session</strong></p>
<ul>
<li>描述：设置oracle连接时的session信息，格式示例如下：<!-- raw HTML omitted --></li>
</ul>
<pre tabindex="0"><code>&#34;session&#34;:[
            &#34;alter session set nls_date_format = &#39;dd.mm.yyyy hh24:mi:ss&#39;;&#34;
            &#34;alter session set NLS_LANG = &#39;AMERICAN&#39;;&#34;
]
</code></pre><ul>
<li>
<p>必选：否 <!-- raw HTML omitted --></p>
</li>
<li>
<p>默认值：无 <!-- raw HTML omitted --></p>
</li>
</ul>
</li>
</ul>
<h3 id="33-类型转换">3.3 类型转换</h3>
<p>类似 OracleReader ，目前 OracleWriter 支持大部分 Oracle 类型，但也存在部分个别类型没有支持的情况，请注意检查你的类型。</p>
<p>下面列出 OracleWriter 针对 Oracle 类型转换列表:</p>
<table>
<thead>
<tr>
<th>DataX 内部类型</th>
<th>Oracle 数据类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>Long</td>
<td>NUMBER,INTEGER,INT,SMALLINT</td>
</tr>
<tr>
<td>Double</td>
<td>NUMERIC,DECIMAL,FLOAT,DOUBLE PRECISION,REAL</td>
</tr>
<tr>
<td>String</td>
<td>LONG,CHAR,NCHAR,VARCHAR,VARCHAR2,NVARCHAR2,CLOB,NCLOB,CHARACTER,CHARACTER VARYING,CHAR VARYING,NATIONAL CHARACTER,NATIONAL CHAR,NATIONAL CHARACTER VARYING,NATIONAL CHAR VARYING,NCHAR VARYING</td>
</tr>
<tr>
<td>Date</td>
<td>TIMESTAMP,DATE</td>
</tr>
<tr>
<td>Boolean</td>
<td>bit, bool</td>
</tr>
<tr>
<td>Bytes</td>
<td>BLOB,BFILE,RAW,LONG RAW</td>
</tr>
</tbody>
</table>
<h2 id="4-性能报告">4 性能报告</h2>
<h3 id="41-环境准备">4.1 环境准备</h3>
<h4 id="411-数据特征">4.1.1 数据特征</h4>
<p>建表语句：</p>
<pre tabindex="0"><code>--DROP TABLE PERF_ORACLE_WRITER;
CREATE TABLE PERF_ORACLE_WRITER (
COL1 VARCHAR2(255 BYTE) NULL ,
COL2 NUMBER(32) NULL ,
COL3 NUMBER(32) NULL ,
COL4 DATE NULL ,
COL5 FLOAT NULL ,
COL6 VARCHAR2(255 BYTE) NULL ,
COL7 VARCHAR2(255 BYTE) NULL ,
COL8 VARCHAR2(255 BYTE) NULL ,
COL9 VARCHAR2(255 BYTE) NULL ,
COL10 VARCHAR2(255 BYTE) NULL
)
LOGGING
NOCOMPRESS
NOCACHE;
</code></pre><p>单行记录类似于：</p>
<pre tabindex="0"><code>col1:485924f6ab7f272af361cd3f7f2d23e0d764942351#$%^&amp;fdafdasfdas%%^(*&amp;^^&amp;*
co12:1
co13:1696248667889
co14:2013-01-06 00:00:00
co15:3.141592653578
co16:100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11209
co17:100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11fdsafdsfdsa209
co18:100DAFDSAFDSAHOFJDPSAWIFDISHAF;dsadsafdsahfdsajf;dsfdsa;FJDSAL;11209
co19:100dafdsafdsahofjdpsawifdishaf;DSADSAFDSAHFDSAJF;dsfdsa;fjdsal;11209
co110:12~!2345100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11209
</code></pre><h4 id="412-机器参数">4.1.2 机器参数</h4>
<ul>
<li>
<p>执行 DataX 的机器参数为:</p>
<ol>
<li>cpu: 24 Core Intel(R) Xeon(R) CPU E5-2430 0 @ 2.20GHz</li>
<li>mem: 94GB</li>
<li>net: 千兆双网卡</li>
<li>disc: DataX 数据不落磁盘，不统计此项</li>
</ol>
</li>
<li>
<p>Oracle 数据库机器参数为:</p>
<ol>
<li>cpu: 4 Core Intel(R) Xeon(R) CPU E5420  @ 2.50GHz</li>
<li>mem: 7GB</li>
</ol>
</li>
</ul>
<h4 id="413-datax-jvm-参数">4.1.3 DataX jvm 参数</h4>
<pre><code>-Xms1024m -Xmx1024m -XX:+HeapDumpOnOutOfMemoryError
</code></pre>
<h4 id="414-性能测试作业配置">4.1.4 性能测试作业配置</h4>
<pre tabindex="0"><code>{
    &#34;job&#34;: {
        &#34;setting&#34;: {
            &#34;speed&#34;: {
                &#34;channel&#34;: 4
            }
        },
        &#34;content&#34;: [
            {
                &#34;reader&#34;: {
                    &#34;name&#34;: &#34;streamreader&#34;,
                    &#34;parameter&#34;: {
                        &#34;sliceRecordCount&#34;: 1000000000,
                        &#34;column&#34;: [
                            {
                                &#34;value&#34;: &#34;485924f6ab7f272af361cd3f7f2d23e0d764942351#$%^&amp;fdafdasfdas%%^(*&amp;^^&amp;*&#34;
                            },
                            {
                                &#34;value&#34;: 1,
                                &#34;type&#34;: &#34;long&#34;
                            },
                            {
                                &#34;value&#34;: &#34;1696248667889&#34;,
                                &#34;type&#34;: &#34;long&#34;
                            },
                            {
                                &#34;type&#34;: &#34;date&#34;,
                                &#34;value&#34;: &#34;2013-07-06 00:00:00&#34;,
                                &#34;dateFormat&#34;: &#34;yyyy-mm-dd hh:mm:ss&#34;
                            },
                            {
                                &#34;value&#34;: &#34;3.141592653578&#34;,
                                &#34;type&#34;: &#34;double&#34;
                            },
                            {
                                &#34;value&#34;: &#34;100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11209&#34;
                            },
                            {
                                &#34;value&#34;: &#34;100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11fdsafdsfdsa209&#34;
                            },
                            {
                                &#34;value&#34;: &#34;100DAFDSAFDSAHOFJDPSAWIFDISHAF;dsadsafdsahfdsajf;dsfdsa;FJDSAL;11209&#34;
                            },
                            {
                                &#34;value&#34;: &#34;100dafdsafdsahofjdpsawifdishaf;DSADSAFDSAHFDSAJF;dsfdsa;fjdsal;11209&#34;
                            },
                            {
                                &#34;value&#34;: &#34;12~!2345100dafdsafdsahofjdpsawifdishaf;dsadsafdsahfdsajf;dsfdsa;fjdsal;11209&#34;
                            }
                        ]
                    }
                },
                &#34;writer&#34;: {
                    &#34;name&#34;: &#34;oraclewriter&#34;,
                    &#34;parameter&#34;: {
                        &#34;username&#34;: &#34;username&#34;,
                        &#34;password&#34;: &#34;password&#34;,
                        &#34;truncate&#34;: &#34;true&#34;,
                        &#34;batchSize&#34;: &#34;512&#34;,
                        &#34;column&#34;: [
                            &#34;col1&#34;,
                            &#34;col2&#34;,
                            &#34;col3&#34;,
                            &#34;col4&#34;,
                            &#34;col5&#34;,
                            &#34;col6&#34;,
                            &#34;col7&#34;,
                            &#34;col8&#34;,
                            &#34;col9&#34;,
                            &#34;col10&#34;
                        ],
                        &#34;connection&#34;: [
                            {
                                &#34;table&#34;: [
                                    &#34;PERF_ORACLE_WRITER&#34;
                                ],
                                &#34;jdbcUrl&#34;: &#34;jdbc:oracle:thin:@ip:port:dataplat&#34;
                            }
                        ]
                    }
                }
            }
        ]
    }
}
</code></pre><h3 id="42-测试报告">4.2 测试报告</h3>
<h4 id="421-测试报告">4.2.1 测试报告</h4>
<table>
<thead>
<tr>
<th>通道数</th>
<th>批量提交行数</th>
<th>DataX速度(Rec/s)</th>
<th>DataX流量(MB/s)</th>
<th>DataX机器网卡流出流量(MB/s)</th>
<th>DataX机器运行负载</th>
<th>DB网卡进入流量(MB/s)</th>
<th>DB运行负载</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>128</td>
<td>15564</td>
<td>6.51</td>
<td>7.5</td>
<td>0.02</td>
<td>7.4</td>
<td>1.08</td>
</tr>
<tr>
<td>1</td>
<td>512</td>
<td>29491</td>
<td>10.90</td>
<td>12.6</td>
<td>0.05</td>
<td>12.4</td>
<td>1.55</td>
</tr>
<tr>
<td>1</td>
<td>1024</td>
<td>31529</td>
<td>11.87</td>
<td>13.5</td>
<td>0.22</td>
<td>13.3</td>
<td>1.58</td>
</tr>
<tr>
<td>1</td>
<td>2048</td>
<td>33469</td>
<td>12.57</td>
<td>14.3</td>
<td>0.17</td>
<td>14.3</td>
<td>1.53</td>
</tr>
<tr>
<td>1</td>
<td>4096</td>
<td>31363</td>
<td>12.48</td>
<td>13.4</td>
<td>0.10</td>
<td>10.0</td>
<td>1.72</td>
</tr>
<tr>
<td>4</td>
<td>10</td>
<td>9440</td>
<td>4.05</td>
<td>5.6</td>
<td>0.01</td>
<td>5.0</td>
<td>3.75</td>
</tr>
<tr>
<td>4</td>
<td>128</td>
<td>42832</td>
<td>16.48</td>
<td>18.3</td>
<td>0.07</td>
<td>18.5</td>
<td>2.89</td>
</tr>
<tr>
<td>4</td>
<td>512</td>
<td>46643</td>
<td>20.02</td>
<td>22.7</td>
<td>0.35</td>
<td>21.1</td>
<td>3.31</td>
</tr>
<tr>
<td>4</td>
<td>1024</td>
<td>39116</td>
<td>16.79</td>
<td>18.7</td>
<td>0.10</td>
<td>18.1</td>
<td>3.05</td>
</tr>
<tr>
<td>4</td>
<td>2048</td>
<td>39526</td>
<td>16.96</td>
<td>18.5</td>
<td>0.32</td>
<td>17.1</td>
<td>2.86</td>
</tr>
<tr>
<td>4</td>
<td>4096</td>
<td>37683</td>
<td>16.17</td>
<td>17.2</td>
<td>0.23</td>
<td>15.5</td>
<td>2.26</td>
</tr>
<tr>
<td>8</td>
<td>128</td>
<td>38336</td>
<td>16.45</td>
<td>17.5</td>
<td>0.13</td>
<td>16.2</td>
<td>3.87</td>
</tr>
<tr>
<td>8</td>
<td>512</td>
<td>31078</td>
<td>13.34</td>
<td>14.9</td>
<td>0.11</td>
<td>13.4</td>
<td>2.09</td>
</tr>
<tr>
<td>8</td>
<td>1024</td>
<td>37888</td>
<td>16.26</td>
<td>18.5</td>
<td>0.20</td>
<td>18.5</td>
<td>3.14</td>
</tr>
<tr>
<td>8</td>
<td>2048</td>
<td>38502</td>
<td>16.52</td>
<td>18.5</td>
<td>0.18</td>
<td>18.5</td>
<td>2.96</td>
</tr>
<tr>
<td>8</td>
<td>4096</td>
<td>38092</td>
<td>16.35</td>
<td>18.3</td>
<td>0.10</td>
<td>17.8</td>
<td>3.19</td>
</tr>
<tr>
<td>16</td>
<td>128</td>
<td>35366</td>
<td>15.18</td>
<td>16.9</td>
<td>0.13</td>
<td>15.6</td>
<td>3.49</td>
</tr>
<tr>
<td>16</td>
<td>512</td>
<td>35584</td>
<td>15.27</td>
<td>16.8</td>
<td>0.23</td>
<td>17.4</td>
<td>3.05</td>
</tr>
<tr>
<td>16</td>
<td>1024</td>
<td>38297</td>
<td>16.44</td>
<td>17.5</td>
<td>0.20</td>
<td>17.0</td>
<td>3.42</td>
</tr>
<tr>
<td>16</td>
<td>2048</td>
<td>28467</td>
<td>12.22</td>
<td>13.8</td>
<td>0.10</td>
<td>12.4</td>
<td>3.38</td>
</tr>
<tr>
<td>16</td>
<td>4096</td>
<td>27852</td>
<td>11.95</td>
<td>12.3</td>
<td>0.11</td>
<td>12.3</td>
<td>3.86</td>
</tr>
<tr>
<td>32</td>
<td>1024</td>
<td>34406</td>
<td>14.77</td>
<td>15.4</td>
<td>0.09</td>
<td>15.4</td>
<td>3.55</td>
</tr>
</tbody>
</table>
<ol>
<li><code>batchSize 和 通道个数，对性能影响较大</code></li>
<li><code>通常不建议写入数据库时，通道个数 &gt;32</code></li>
</ol>
<h2 id="5-约束限制">5 约束限制</h2>
<h2 id="faq">FAQ</h2>
<hr>
<p><strong>Q: OracleWriter 执行 postSql 语句报错，那么数据导入到目标数据库了吗?</strong></p>
<p>A: DataX 导入过程存在三块逻辑，pre 操作、导入操作、post 操作，其中任意一环报错，DataX 作业报错。由于 DataX 不能保证在同一个事务完成上述几个操作，因此有可能数据已经落入到目标端。</p>
<hr>
<p><strong>Q: 按照上述说法，那么有部分脏数据导入数据库，如果影响到线上数据库怎么办?</strong></p>
<p>A: 目前有两种解法，第一种配置 pre 语句，该 sql 可以清理当天导入数据， DataX 每次导入时候可以把上次清理干净并导入完整数据。第二种，向临时表导入数据，完成后再 rename 到线上表。</p>
<hr>
<p><strong>Q: 上面第二种方法可以避免对线上数据造成影响，那我具体怎样操作?</strong></p>
<p>A: 可以配置临时表导入</p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://haokiu.com/tags/datax/">datax</a></li>
    </ul>

  </footer>
</article>
    </main>
    
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
